<VirtualHost *:80>
    ServerName localhost
    DocumentRoot "/mnt/D/Work/GulfContractors/GC_resumefilter/frontend/dist"

    # Frontend - Serve React build
    <Directory "/mnt/D/Work/GulfContractors/GC_resumefilter/frontend/dist">
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
        
        # Handle React Router - redirect all requests to index.html
        FallbackResource /index.html
    </Directory>

    # Backend API - Proxy to FastAPI running on port 8000
    ProxyPreserveHost On
    ProxyPass /api http://127.0.0.1:8000
    ProxyPassReverse /api http://127.0.0.1:8000

    # WebSocket support (if needed in future)
    RewriteEngine on
    RewriteCond %{HTTP:Upgrade} websocket [NC]
    RewriteCond %{HTTP:Connection} upgrade [NC]
    RewriteRule ^/api/?(.*) "ws://127.0.0.1:8000/$1" [P,L]

    # Logs
    ErrorLog "${APACHE_LOG_DIR}/gc_resumefilter_error.log"
    CustomLog "${APACHE_LOG_DIR}/gc_resumefilter_access.log" combined

    # Security headers
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-XSS-Protection "1; mode=block"
</VirtualHost>
